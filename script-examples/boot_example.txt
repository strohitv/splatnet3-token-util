############################
# STEPS FILE DOCUMENTATION #
############################
# 
# This file contains the steps required to open the NSO SplatNet 3 app.
# It starts executing AFTER the emulator has been started.
# Once this file has been fully executed, the script will create a snapshot of the emulator.
# Your goal for this script is to bring the freshly booted emulator to a state where the NSO app is opened and has entered SplatNet 3.
#
# Available commands:
# - Use # at the start of a line to create a comment (line will be ignored)
# - WARNING: # after a command will lead to an error, # must be at the start of a line
#
# - block_until_screenshot_region_matches: waits a region in a screenshot to match the template provided. If the region does not match, it will wait for [DURATION] milliseconds.
#    - Use: "block_until_screenshot_region_matches [TEMPLATE_SCREENSHOT] [REGION_X1] [REGION_Y1] [REGION_X2] [REGION_Y2] [DURATION_MS] [ACTUAL_SCREENSHOT_PATH]" to do the comparison.
#        - [TEMPLATE_SCREENSHOT]: a file path to a screenshot which will be used as the base for comparison.
#        - [REGION_X1]: X coordinate of the top left corner of the region to be compared.
#        - [REGION_Y1]: Y coordinate of the top left corner of the region to be compared.
#        - [REGION_X2]: X coordinate of the bottom right corner of the region to be compared.
#        - [REGION_Y2]: Y coordinate of the bottom right corner of the region to be compared.
#        - [DURATION_MS]: Optional duration in ms to wait before attempting again. It will wait for 1000 ms if no value is provided.
#        - [ACTUAL_SCREENSHOT_PATH]: Optional path in which the screenshot will be saved. It will save to './screenshot.png' if no value is provided.
#    - Example 1: "block_until_screenshot_region_matches -f ./base.png -x1 100 -y1 200 -x2 300 -y2 400 -d 2000 -asp ./compare.png" to compare the rectangle from (100, 200) to (300, 400) of base.png and compare.png. If not found, wait for 2 seconds.
#    - Example 2: "block_until_screenshot_region_matches --filename ./base.png --x1 100 --y1 200 --x2 300 --y2 400 --duration 2000 --actual_screenshot_path ./compare.png" to compare the rectangle from (100, 200) to (300, 400) of base.png and compare.png. If not found, wait for 2 seconds.
#
# - echo: prints a given text to the command line.
#    - Use: "echo [TEXT]" to print [TEXT]. If no text is given, it will print a new line.
#    - Example 1: "echo hello, this is a test" to print "hello, this is a test"
#    - Example 2: "echo" to print a new line
#
# - long_press_power_button: presses the power button for a long time.
#    - Use: "long_press_power_button" to press the power button for a long time.
#
# - swipe: swipes from a given position to another given position on the screen.
#    - Use: "swipe [X1] [Y1] [X2] [Y2] [DURATION_MS]" to swipe from position (X1, Y1) to (X2, Y2) on the screen for [DURATION_MS] milliseconds.
#          If no duration is given, the swipe will last for 500 ms.
#    - Example 1: "swipe -x1 100 -y1 200 -x2 300 -y2 400 -d 500" to swipe from position (100, 200) to (300, 400) on the screen for 500 ms.
#    - Example 2: "swipe --x1 100 --y1 200 --x2 300 --y2 400 --duration 500" to swipe from position (100, 200) to (300, 400) on the screen for 500 ms.
#
# - tap: taps a given position on the screen.
#    - Use: "tap [X] [Y]" to tap the position (X, Y) on the screen.
#    - Example 1: "tap -x 100 -y 200" to tap the position (100, 200) on the screen.
#    - Example 2: "tap --x 100 --y 200" to tap the position (100, 200) on the screen.
#
# - wait_s: waits for a given amount of seconds.
#    - Use: "wait_s [NUMBER]" to wait for [NUMBER] seconds. If no number is given, it will wait for 5 seconds.
#    - Example: "wait_s 10" to wait 10 seconds
#
# - wait_ms: waits for a given amount of milliseconds.
#    - Use: "wait_ms [NUMBER]" to wait for [NUMBER] ms. If no number is given, it will wait for 5000 ms (= 5 seconds).
#    - Example: "wait_ms 500" to wait 500 ms (0.5 seconds)

echo
echo Open NSO app
tap -x 150 -y 630
wait_s 1
tap -x 150 -y 630
wait_s 1
tap -x 150 -y 630
block_until_screenshot_region_matches -f ./screenshots/template-nso-opened.png -x1 7 -y1 175 -x2 308 -y2 236 -d 1000 -asp ./screenshots/nso-opened-screenshot.png

echo
echo Open SplatNet3
tap -x 275 -y 1075
wait_s 1
tap -x 275 -y 1075
wait_s 1
tap -x 275 -y 1075
block_until_screenshot_region_matches -f ./screenshots/template-splatnet3-opened.png -x1 980 -y1 170 -x2 1060 -y2 220 -d 500 -asp ./screenshots/splatnet3-opened-screenshot.png
